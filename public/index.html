<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PNS Estimator</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>üõ¢Ô∏è PNS Estimator</h1>
            <p>Petroleum Network Solutions - Quote Builder</p>
        </header>

        <div class="actions">
            <button onclick="app.exportJSON()" class="btn btn-primary">üíæ Export JSON</button>
            <button onclick="app.importJSON()" class="btn btn-primary">üì• Import JSON</button>
            <button onclick="app.shareURL()" class="btn btn-success">üîó Share Link</button>
            <button onclick="app.sendToContractor()" class="btn btn-warning">üì§ Send to Contractor</button>
            <button onclick="app.generatePDF()" class="btn btn-danger">üìÑ Generate PDF</button>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="app.switchTab('info')">Project Info</button>
            <button class="tab" onclick="app.switchTab('plans')">Site Plans & Files</button>
            <button class="tab" onclick="app.switchTab('items')">Line Items</button>
            <button class="tab" onclick="app.switchTab('summary')">Summary</button>
        </div>

        <!-- TAB: Info -->
        <div id="tab-info" class="tab-content active">
            <h2>Project Information</h2>
            
            <div class="form-grid">
                <div class="form-group">
                    <label>Client Name</label>
                    <input type="text" id="clientName" onchange="app.save()">
                </div>
                <div class="form-group">
                    <label>Site Address</label>
                    <input type="text" id="siteAddress" onchange="app.save()">
                </div>
                <div class="form-group">
                    <label>Quote Date</label>
                    <input type="date" id="quoteDate" onchange="app.save()">
                </div>
                <div class="form-group">
                    <label>Quote Number</label>
                    <input type="text" id="quoteNumber" onchange="app.save()">
                </div>
            </div>

            <h3>Your Company Info</h3>
            <div class="form-grid">
                <div class="form-group">
                    <label>Company Name</label>
                    <input type="text" id="companyName" value="Petroleum Network Solutions" onchange="app.save()">
                </div>
                <div class="form-group">
                    <label>Contact Name</label>
                    <input type="text" id="contactName" value="Thomas Lyons" onchange="app.save()">
                </div>
                <div class="form-group">
                    <label>Phone</label>
                    <input type="tel" id="phone" value="817-888-6167" onchange="app.save()">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="email" value="tlyons@petronetwrksolutions.com" onchange="app.save()">
                </div>
            </div>
        </div>

        <!-- TAB: Site Plans & Files -->
        <div id="tab-plans" class="tab-content">
            <h2>Site Plans & Files</h2>
            
            <div class="info-banner" style="background: #d1ecf1; border-left-color: #17a2b8;">
                <strong>üìé Upload Files:</strong> Attach site plans, blueprints, photos, or any documents. Files are embedded in the shareable link and JSON export.
            </div>

            <div class="form-group">
                <label>Upload Files (PDFs, Images, Documents)</label>
                <input type="file" id="fileUpload" multiple accept=".pdf,.jpg,.jpeg,.png,.doc,.docx,.xls,.xlsx" onchange="app.handleFileUpload(event)">
                <small style="color: #666; margin-top: 5px; display: block;">Max 5MB per file. Files will be embedded as base64.</small>
            </div>

            <h3>Uploaded Files</h3>
            <div id="filesList" class="files-list">
                <p style="color: #999; font-style: italic;">No files uploaded yet</p>
            </div>

            <h3>Notes / Special Instructions</h3>
            <div class="form-group">
                <textarea id="projectNotes" rows="8" onchange="app.save()" placeholder="Add any special instructions, site conditions, requirements, etc."></textarea>
            </div>
        </div>

        <!-- TAB: Line Items -->
        <div id="tab-items" class="tab-content">
            <h2>Line Items</h2>
            
            <div class="info-banner">
                <strong>üí° Tip:</strong> Export JSON to send to contractors for pricing, then import their updates to merge data.
            </div>

            <div id="categorySections"></div>
        </div>

        <!-- TAB: Line Items (OLD - REMOVE THIS) -->
        <div id="tab-items-old" class="tab-content" style="display: none;">
            <h2>Line Items</h2>
            
            <div class="info-banner">
                <strong>üí° Tip:</strong> Export JSON to send to others for pricing, then import their updates to merge data.
            </div>

            <div class="table-container">
                <table id="itemsTable">
                    <thead>
                        <tr>
                            <th style="width: 40%;">Description</th>
                            <th style="width: 100px;">QTY</th>
                            <th style="width: 120px;">Unit Price</th>
                            <th style="width: 120px;">Total</th>
                            <th style="width: 60px;"></th>
                        </tr>
                    </thead>
                    <tbody id="itemsBody">
                    </tbody>
                </table>
            </div>

            <button onclick="app.addItem()" class="btn btn-add">+ Add Line Item</button>
        </div>

        <!-- TAB: Summary -->
        <div id="tab-summary" class="tab-content">
            <h2>Quote Summary</h2>
            
            <div class="summary-box">
                <div class="summary-line">
                    <span>Subtotal:</span>
                    <span id="subtotal">$0.00</span>
                </div>
                <div class="summary-line">
                    <label>
                        <span>Tax (%):</span>
                        <input type="number" id="taxRate" value="8.25" step="0.01" onchange="app.calculateTotals()" style="width: 80px;">
                    </label>
                    <span id="taxAmount">$0.00</span>
                </div>
                <div class="summary-line">
                    <span>Discount:</span>
                    <input type="number" id="discount" value="0" step="0.01" onchange="app.calculateTotals()" style="width: 120px;">
                </div>
                <div class="summary-line total">
                    <span><strong>TOTAL:</strong></span>
                    <span id="grandTotal"><strong>$0.00</strong></span>
                </div>
            </div>

            <h3>Payment Terms</h3>
            <div class="form-group">
                <label>Payment Schedule / Notes</label>
                <textarea id="paymentTerms" rows="6" onchange="app.save()" placeholder="Enter payment milestones, terms, etc."></textarea>
            </div>

            <h3>Scope of Work</h3>
            <div class="form-group">
                <textarea id="scopeOfWork" rows="8" onchange="app.save()" placeholder="Describe the scope of work..."></textarea>
            </div>
        </div>
    </div>

    <input type="file" id="fileInput" accept=".json" style="display: none;" onchange="app.handleFileImport(event)">

    <div id="notification" class="notification"></div>

    <script src="js/app.js"></script>
</body>
</html>
